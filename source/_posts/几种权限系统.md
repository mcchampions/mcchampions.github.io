---
title: 几种权限系统
date: 2024-07-10 21:23:35
tag:
  - 二进制
  - 权限系统
  - 程序设计
category: 
  - Java
---

## 前言
在开发程序网站中，总是要涉及到权限的判断.
各种权限系统五花八门.
## 各种权限系统
### Bukkit的权限系统
像是Bukkit的权限系统，有着`用户`,`组`,`权限值`,`继承`这四大设定.
`组`与`用户`都有着许多`权限值`，`组`与`组`之间可以有着`继承`的关系，即一个`组`拥有另一个`组`的所有权限值。
`组`中还包含`用户`，每个`用户`都分配到一个`组`，`用户`拥有他所在的`组`的所有权限值。同时`用户`可以不只分配到一个`组·`，他可以有多个，他同时拥有这些`组`的权限。
`权限值`是一串字符串，它有几个`节点`组成，如`node1.node2.node3`，此外，还有着特殊的节点`*`。想必大家都很熟悉它，`node1.node2.*`包含了`node1,node2.node3`与`node1.node2.node4`等`权限值`。
同时`权限值`还有`前缀`————`+` or `-`，默认情况下是可以不加`前缀`的，这时候它的前缀默认为`+`:
当我有一个`用户`，他有着这样的`权限值`————`a.b.*`，我现在又不想让他有`a.b.e`，可是`a.b`这个`节点`下面包含了许多有用的`节点`，难道我要把其他种搭配的`权限值`全部列出来吗，这时候`前缀`就用上场了。
我只需要再给他一个`权限值`————`- a.b.e`就可以做到排除这个权限值。
所以两个`前缀`的意思就明了了。
`+`代表着 有
`-`代表着 排除
### RBAC
有的人看完了上面的Bukkit的权限系统发现很眼熟，他其实就是一个RBAC模型的变种，大差不差，具体可以看[全网最全的权限系统设计方案，不接受反驳！](https://cloud.tencent.com/developer/article/2314166)
### ABAC
ABAC的设计令人看着都感到头疼。但其实总结下来，就是对每一个`行为`进行约束。
就是当满足什么`条件`时允许一个`操作`。
ABAC有着许多不同的实现，我就不细讲了。具体可以看[史上最强的权限系统设计攻略(下)、ABAC在复杂场景下的实现思路](https://juejin.cn/post/6951712306598248485)
我们再来理解下ABAC，就是`用户`在进行一个`操作`时，你只要判断可以执行这个`操作`的`条件`就行。在进行设计时，你只需要将每种`操作`的`条件`列出来就行。
### ACL与DAC
ACL的设计就是，列出了那些用户可以进行`操作被操作对象`的行为。
就像当`用户``删除文件`时，它是先获取`删除文件`这个行为允许那些`用户`执行，在判断有没有这个执行的`用户`。
DAC和ACL的区别大差不差，只不过DAC允许`操作被操作对象`这个行为所允许执行的`用户`将别的`用户`也添加到这个列表里，即可以将权限授予别人。
## 进行改善
讲完了这么多权限系统的设计，它们都有一个缺点，就是会变得越来越臃肿，这无法解决，只能缓解。
我们先从权限入手，权限是能否进行一个操作的根据，可以有各种各样的方式来表示它，像是bukkit的字符串形式，这种形式可能表达起来就要占不少的空间。
我们可以用二进制表达一个权限，每个权限都是由几个0与一个1构成，即1,10,100,1000这种形式。
每个权限的每位都不一样，通过进行 或 运算就可以把这些权限组合起来，判断就通过 与 运算(将存储的用户的二进制权限和判断的二进制权限进行运算在判断是否等于这个判断的二进制权限，示例：判断拥有permission权限的用户是否有target权限——`(permission & target) == target`)，原先一长串的字符串就变成了一长串的数字，由于是二进制，还有进一步缩减的余地，我们可以存储为16进制，它所占的空间大大减小。
在你有很多不同的权限时，使用二进制进行存储会大大减少你权限系统所占用的空间，缺点就是更**不直观**了。

就算我们仍然使用字符串进行存储，我们也可以通过想bukkit使用通配符或类似的设计指定一个权限包含了各种不同的权限,
以及它的前缀这个设计，我个人认为是非常好的
